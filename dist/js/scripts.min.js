var dR=function(t){var e=[],n="https://rickandmortyapi.com/api/character/?status=dead",a={pages:1,next:n};function o(t){a.pages=t.pages,a.next=t.next}function r(){var i=t.Deferred();return a.next||(a.next=n),t.ajax(a.next,{method:"GET",dataType:"json",timeout:4e3}).then(function(n){console.log(n),o(n.info);var a=n.results;t.each(a,function(t){var n,o={name:a[t].name,detailsUrl:a[t].url};"object"==typeof(n=o)?e.push(n):console.log("Please add an object"),i.resolve()})}).catch(function(t){console.log("Sorry! Error: "+t.statusText),i.reject()}),i.promise()}function s(e){var n,a,i;(n=e,a=t.Deferred(),i=n.detailsUrl,t.ajax(i,{method:"GET",dataType:"json",timeout:2e3}).then(function(t){n.species=t.species,n.gender=t.gender,n.origin=t.origin.name,n.location=t.location.name,n.imageUrl=t.image,a.resolve()}).catch(function(t){console.log("Sorry! Error: "+t.statusText),a.reject()}),a.promise()).then(function(){console.log(e),l(e)})}function l(e){t(".modal-title").text(e.name),t(".modal-body").empty().append('<img class="modal-img"/>').append('<p class="modal-birth"><p>').append('<p class="modal-death"><p>').append('<p class="modal-species"><p>'),t(".modal-img").attr("src",e.imageUrl),t(".modal-birth").text(function(t){if("unknown"===t.origin)return t.name+"´s birthplace is not known.";return t.name+" recieved the gift of life on "+t.origin+"."}(e)),t(".modal-death").text(function(t){if("unknown"===t.location)return t.name+" went missing.";return c(t)+" final place of rest is "+t.location+"."}(e)),t(".modal-species").text(function(t){if("unknown"===t.species)return c(t)+" family values the time they had together.";return c(t)+" "+t.species+" family values the time they had together."}(e))}function c(t){return"Female"===t.gender?"Her":"Male"===t.gender?"His":t.name+"´s"}return t(document).ready(function(){dR.loadList().then(function(){dR.printList()}).then(function(){dR.loadListRepeater().then(function(){dR.printList()})}),t(".search").attr("oninput","dR.updateList(this.value)")}),{printList:function(){var e=dR.getAll();t.each(e,function(t,e){dR.addListItem(e)})},updateList:function(e){t("#data-list").empty();var n=dR.filterByName(e);t.each(n,function(t,e){dR.addListItem(e)})},filterByName:function(t){return e.filter(function(e){return-1!=e.name.toLowerCase().indexOf(t.toLowerCase())})},showModal:l,updateUrl:o,showDetails:s,addListItem:function(e){t("#data-list").append('<button type="button" class="list-item__button list-group-item list-group-item-action"></button>'),t(".list-item__button").last().attr("data-toggle","modal").attr("data-target","#detailsModal").text(e.name).click(function(t){s(e)})},getAll:function(){return e},loadList:r,loadListRepeater:async function(){for(i=1;i<a.pages;i++)await r()}}}(jQuery);
